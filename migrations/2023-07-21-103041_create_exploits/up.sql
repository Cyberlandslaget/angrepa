CREATE TABLE exploits (
    -- unique id
    id TEXT PRIMARY KEY,
    running BOOLEAN NOT NULL DEFAULT FALSE,
    attack_target TEXT,
    -- the image id
    docker_image TEXT NOT NULL,
    -- the type (for recreating the actual instance)
    exploit_kind TEXT NOT NULL
);

CREATE TABLE flags (
    -- flag itself
    flag TEXT NOT NULL PRIMARY KEY,

    -- the tick the flag was submitted
    tick INTEGER,
    -- time of submission
    stamp TIMESTAMP,

    -- the exploit that submitted this flag
    exploit_id TEXT,
    -- target ip
    target_ip TEXT,
    -- service that was exploited
    flagstore TEXT,

    -- sent to gameserver?
    sent BOOLEAN NOT NULL DEFAULT FALSE,
    -- status. None = no response yet. Some(x) = status is x
    status TEXT
);

CREATE TABLE runlogs (
    -- unique incrementing id
    id SERIAL PRIMARY KEY,

    -- metadata
    from_exploit_id TEXT NOT NULL,
    from_ip TEXT NOT NULL,

    tick INTEGER NOT NULL,
    stamp TIMESTAMP NOT NULL,
    content TEXT NOT NULL
)
